

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Training Data Format &mdash; Rasa Core 0.7.0a9 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/banner.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Rasa Core 0.7.0a9 documentation" href="index.html"/>
        <link rel="next" title="Scheduling Reminders" href="scheduling.html"/>
        <link rel="prev" title="Connecting to messaging &amp; voice platforms" href="connectors.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Rasa Core
          

          
          </a>

          
            
            
              <div class="version">
                0.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="read_first.html">Read this first</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation and Hello World</a></li>
<li class="toctree-l1"><a class="reference internal" href="tour.html">A Quick Tour (no ML)</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_scratch.html">A Bot From Scratch</a></li>
</ul>
<p class="caption"><span class="caption-text">More Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorial_babi.html">Supervised Learning Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_fake_user.html">Interactive Learning with a Fake User</a></li>
</ul>
<p class="caption"><span class="caption-text">Deep Dives</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="patterns.html">Common Patterns</a></li>
<li class="toctree-l1"><a class="reference internal" href="plumbing.html">Plumbing - How it all fits together</a></li>
<li class="toctree-l1"><a class="reference internal" href="http.html">Rasa Core as a HTTP server</a></li>
<li class="toctree-l1"><a class="reference internal" href="domains.html">Domain, Slots, and Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="connectors.html">Connecting to messaging &amp; voice platforms</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Training Data Format</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#visualization-of-story-training-data">Visualization of story training data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="scheduling.html">Scheduling Reminders</a></li>
</ul>
<p class="caption"><span class="caption-text">Python API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/agent.html">Agent</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/events.html">Events</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="featurisation.html">Featurization</a></li>
<li class="toctree-l1"><a class="reference internal" href="interpreters.html">Interpreters</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.html">Creating Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="state.html">Tracking Conversation State</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Change Log</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Rasa Core</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Training Data Format</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/stories.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  


    
    



    <p class="scv-banner scv-sphinx_rtd_theme"><a href="../0.8.5/stories.html"><b>Warning:</b> This document is for an old version of Rasa Core. The latest version is 0.8.5.</a></p>

<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="training-data-format">
<span id="stories"></span><h1>Training Data Format<a class="headerlink" href="#training-data-format" title="Permalink to this headline">¶</a></h1>
<p>Here&#8217;s an example from the bAbi data:</p>
<div class="highlight-md"><div class="highlight"><pre><span></span><span class="gu">##</span> story_07715946
<span class="k">*</span> _greet
   <span class="k">-</span> action_ask_howcanhelp
<span class="k">*</span> _inform[location=rome,price=cheap]
   <span class="k">-</span> action_on_it
   <span class="k">-</span> action_ask_cuisine
<span class="k">*</span> _inform[cuisine=spanish]
   <span class="k">-</span> action_ask_numpeople
<span class="k">*</span> _inform[people=six]
   <span class="k">-</span> action_ack_dosearch
</pre></div>
</div>
<p>This is what we call a <strong>story</strong>. A story starts with a name preceeded by two
hashes <code class="docutils literal"><span class="pre">##</span> <span class="pre">story_03248462</span></code>, this is arbitrary but can be used for debugging.
After this point, we have two types of events which sequentially happen when separated by a newline.</p>
<p>An event such as <code class="docutils literal"><span class="pre">*</span> <span class="pre">_inform[location=bombay]</span></code> is a user utterance. These utterances are written like <code class="docutils literal"><span class="pre">*</span> <span class="pre">_{intent}[{entities}]</span></code>.
The intent and entities provided (as well as those in the past)
are the input features to the neural network which then predicts the bot’s next action,
which is in the format <code class="docutils literal"><span class="pre">-</span> <span class="pre">action_{action_name}</span></code> where actions can be anything from a bot response sent
to the user or something internal. For example in our case,
<code class="docutils literal"><span class="pre">-</span> <span class="pre">action_store_stot</span></code> stores the entities given by the user into internal slots within the bot. The user will not
see this step. However, something such as <code class="docutils literal"><span class="pre">-</span> <span class="pre">action_ask_howcanhelp</span></code> is the bot asking how it can help.</p>
<p>The end of a story is denoted by a newline, and then a new story starts again with <code class="docutils literal"><span class="pre">##</span></code>.</p>
<div class="section" id="visualization-of-story-training-data">
<span id="story-visualization"></span><h2>Visualization of story training data<a class="headerlink" href="#visualization-of-story-training-data" title="Permalink to this headline">¶</a></h2>
<p>Sometimes it is helpful to get an overview of the conversational paths that are described within a story file. To make
debugging easier and to ease discussions about bot flows, you can visualize the content of a story file. For this to
work, you need to install graphviz. These are the instructions to do that on OSX, for other systems the instructions
might be slightly different:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>brew install graphviz
pip install pygraphviz --install-option<span class="o">=</span><span class="s2">&quot;--include-path=/usr/include/graphviz&quot;</span> --install-option<span class="o">=</span><span class="s2">&quot;--library-path=/usr/lib/graphviz/&quot;</span>
</pre></div>
</div>
<p>As soon as this is installed you can visualize stories like this:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>python -m rasa_core.visualize -d examples/concerts/data/stories.md -o graph.png
</pre></div>
</div>
<p>This will run through the stories in <code class="docutils literal"><span class="pre">examples/concerts/data/stories.md</span></code> and create a graph stored in the
output image <code class="docutils literal"><span class="pre">graph.png</span></code>.</p>
<img alt="_images/concert_stories.png" src="_images/concert_stories.png" />
<p>You can also call the visualization directly from your code using:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rasa_core.training_utils</span> <span class="k">import</span> <span class="n">create_stories_from_file</span>
<span class="kn">from</span> <span class="nn">rasa_core.training_utils.visualization</span> <span class="k">import</span> <span class="n">visualize_stories</span>
<span class="kn">from</span> <span class="nn">rasa_nlu.converters</span> <span class="k">import</span> <span class="n">load_data</span>

<span class="n">stories</span> <span class="o">=</span> <span class="n">create_stories_from_file</span><span class="p">(</span><span class="s2">&quot;examples/babi/data/babi_task5_dev_rasa_even_smaller.md&quot;</span><span class="p">)</span>
<span class="n">training_data</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;examples/babi/data/babi_dialog_nlu.json&quot;</span><span class="p">)</span>
<span class="n">visualize_stories</span><span class="p">(</span><span class="n">stories</span><span class="p">,</span> <span class="s2">&quot;graph.png&quot;</span><span class="p">,</span> <span class="n">training_data</span><span class="o">=</span><span class="n">training_data</span><span class="p">)</span>
</pre></div>
</div>
<p>Which will create the same image as the above python script call. The shown graph is still very simple, but the graphs can get quite complex.</p>
<p>If you want to replace the intent &amp; entity messages in the box with real world messages
(if you want to replace the messages from the stories file, which
usually look like <code class="docutils literal"><span class="pre">_greet</span></code> with real messages e.g. <code class="docutils literal"><span class="pre">hello</span></code>), you can pass in a Rasa
NLU training data instance to replace them with messages from your training data, as we
did in the above example with the <code class="docutils literal"><span class="pre">training_data</span></code> variable.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="scheduling.html" class="btn btn-neutral float-right" title="Scheduling Reminders" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="connectors.html" class="btn btn-neutral" title="Connecting to messaging &amp; voice platforms" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Rasa Technologies GmbH.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: 0.6.9
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Tags</dt>
            <dd><a href="../0.8.5/stories.html">0.8.5</a></dd>
            <dd><a href="../0.8.4/stories.html">0.8.4</a></dd>
            <dd><a href="../0.8.3/stories.html">0.8.3</a></dd>
            <dd><a href="../0.8.2/stories.html">0.8.2</a></dd>
            <dd><a href="../0.8.1/stories.html">0.8.1</a></dd>
            <dd><a href="../0.8.0/stories.html">0.8.0</a></dd>
            <dd><a href="../0.7.9/stories.html">0.7.9</a></dd>
            <dd><a href="stories.html">0.6.9</a></dd>
        </dl>
        <dl>
            <dt>Branches</dt>
            <dd><a href="../master/stories.html">master</a></dd>
        </dl>
    </div>
</div>


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.7.0a9',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>